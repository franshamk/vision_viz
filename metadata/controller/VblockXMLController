{
    "type": "Ext.app.Controller",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "designer|userClassName": "VblockXMLController"
    },
    "designerId": "45e13f6d-91c7-4914-ac82-4fd329a935b7",
    "cn": [
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "fetchVBlockXML",
                "designer|params": [
                    "url"
                ],
                "implHandler": [
                    "var me = this;\r",
                    "\r",
                    "// need to wait until a ticket granting ticket exists. \r",
                    "if(!me.ticketGrantingtTicket) {\r",
                    "    Ext.defer(me.fetchVBlockXML, 50, this);\r",
                    "    return;\r",
                    "}\r",
                    "\r",
                    "// NExt, get a service ticket. \r",
                    "\r",
                    "Ext.Ajax.request({\r",
                    "    method: 'POST',\r",
                    "    url: me.ticketGrantingTicket,\r",
                    "    params: {\r",
                    "    \tservice: url\r",
                    "    },\r",
                    "    useDefaultXhrHeader: false,\r",
                    "    success: function(data) {        \r",
                    "        alert(data.responseText);\r",
                    "    }\r",
                    "});\r",
                    "\r",
                    ""
                ]
            },
            "designerId": "32af46b9-416e-4e9a-bd57-eeb207e5e994"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "getTicketGrantingTicket",
                "implHandler": [
                    "var me = this;\r",
                    "var cas = \"https://fm-sim-nimsoft.internal.superna.net:8443/cas/v1/tickets\";\r",
                    "//var cas = \"ajax/tickets.xml\";\r",
                    "var params = \"username=admin&password=dangerous\";\r",
                    "\r",
                    "Ext.Ajax.request({\r",
                    "    method: 'POST',\r",
                    "    url: cas,\r",
                    "    params: {\r",
                    "    \tusername: 'admin',\r",
                    "    \tpassword: 'dangerous'\r",
                    "    },\r",
                    "    useDefaultXhrHeader: false,\r",
                    "    success: function(data) {        \r",
                    "        var el = document.createElement('div');\r",
                    "        el.innerHTML = data.responseText;        \r",
                    "        var list = el.getElementsByTagName('form');\r",
                    "        me.ticketGrantingTicket = list[0].action;\r",
                    "    }\r",
                    "});"
                ]
            },
            "designerId": "af3cbfd9-bd02-4afe-af3b-12f59bc65849"
        },
        {
            "type": "fixedfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "init",
                "designer|params": [
                    "application"
                ],
                "implHandler": [
                    "this.getTicketGrantingTicket();"
                ]
            },
            "designerId": "81465ace-cf52-4455-88d6-138ceb7cf159"
        }
    ]
}